<Window x:Class="ImageGallery.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Image Gallery" 
        Height="600" 
        Width="800"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResize"
        WindowState="Normal"
        Background="Black"
        KeyDown="Window_KeyDown"
        Loaded="Window_Loaded">
    <Grid>
        <!-- Mosaic Grid -->
        <ItemsControl x:Name="MosaicDisplay" MouseWheel="MosaicDisplay_MouseWheel"
                      MouseLeftButtonDown="MosaicDisplay_MouseLeftButtonDown"
                      MouseLeftButtonUp="MosaicDisplay_MouseLeftButtonUp"
                      MouseMove="MosaicDisplay_MouseMove">
            <ItemsControl.RenderTransform>
                <TransformGroup>
                    <ScaleTransform x:Name="MosaicScaleTransform" ScaleX="1" ScaleY="1"/>
                    <TranslateTransform x:Name="MosaicTranslateTransform" X="0" Y="0"/>
                </TransformGroup>
            </ItemsControl.RenderTransform>
            <ItemsControl.RenderTransformOrigin>0.5,0.5</ItemsControl.RenderTransformOrigin>
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid x:Name="MosaicGrid" Rows="1" Columns="1"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Image Source="{Binding}" 
                           Stretch="Uniform" 
                           HorizontalAlignment="Center" 
                           VerticalAlignment="Center"/>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
        
        <!-- Loading Overlay -->
        <Border x:Name="LoadingOverlay" 
                Background="#DD000000" 
                Visibility="Visible">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock x:Name="LoadingText" 
                          Text="Loading images..." 
                          Foreground="White" 
                          FontSize="20" 
                          HorizontalAlignment="Center"
                          Margin="0,0,0,20"/>
                
                <!-- Import Progress -->
                <StackPanel x:Name="ImportProgressStack" Visibility="Collapsed" Margin="0,0,0,15">
                    <TextBlock Text="Importing files..." 
                              Foreground="#CCCCCC" 
                              FontSize="14" 
                              HorizontalAlignment="Center"
                              Margin="0,0,0,5"/>
                    <ProgressBar x:Name="ImportProgressBar" 
                                Width="300" 
                                Height="15" 
                                Minimum="0" 
                                Maximum="100" 
                                Value="0"/>
                    <TextBlock x:Name="ImportDetailsText" 
                              Text="" 
                              Foreground="#999999" 
                              FontSize="11" 
                              HorizontalAlignment="Center"
                              Margin="0,5,0,0"/>
                </StackPanel>
                
                <!-- Loading Progress -->
                <StackPanel x:Name="LoadingProgressStack" Visibility="Visible">
                    <TextBlock Text="Loading images..." 
                              Foreground="#CCCCCC" 
                              FontSize="14" 
                              HorizontalAlignment="Center"
                              Margin="0,0,0,5"/>
                    <ProgressBar x:Name="LoadingProgressBar" 
                                Width="300" 
                                Height="15" 
                                Minimum="0" 
                                Maximum="100" 
                                Value="0"/>
                    <TextBlock x:Name="LoadingDetailsText" 
                              Text="" 
                              Foreground="#999999" 
                              FontSize="11" 
                              HorizontalAlignment="Center"
                              Margin="0,5,0,0"/>
                </StackPanel>
                
                <!-- Shortcuts Guide -->
                <Border BorderBrush="#444444" 
                        BorderThickness="1" 
                        Padding="20" 
                        Margin="0,30,0,0"
                        Background="#22FFFFFF">
                    <StackPanel>
                        <TextBlock Text="KEYBOARD SHORTCUTS" 
                                  Foreground="White" 
                                  FontSize="14" 
                                  FontWeight="Bold"
                                  HorizontalAlignment="Center"
                                  Margin="0,0,0,10"/>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="Arrow Keys:" FontWeight="Bold"/> Navigate images
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="Space / Enter:" FontWeight="Bold"/> Pause/Resume slideshow
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="F:" FontWeight="Bold"/> Toggle fullscreen
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="D:" FontWeight="Bold"/> Toggle debug console
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="Shift + &lt;:" FontWeight="Bold"/> Increase speed (+0.5s)
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="Shift + &gt;:" FontWeight="Bold"/> Decrease speed (-0.5s)
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="M:" FontWeight="Bold"/> Increase mosaic panes
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="N:" FontWeight="Bold"/> Decrease mosaic panes
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="Ctrl+W:" FontWeight="Bold"/> Close app
                        </TextBlock>
                        <TextBlock Foreground="#CCCCCC" FontSize="11" Margin="0,2">
                            <Run Text="Ctrl+Q:" FontWeight="Bold"/> Close and delete all images
                        </TextBlock>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>
        
        <!-- Left Flash -->
        <Grid x:Name="LeftFlash" 
              Opacity="0"
              HorizontalAlignment="Left"
              VerticalAlignment="Stretch"
              Width="100"
              ClipToBounds="True">
            <Ellipse Fill="White" 
                     Width="200" 
                     Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Window}}"
                     HorizontalAlignment="Left"
                     Margin="-100,0,0,0"/>
        </Grid>
        
        <!-- Right Flash -->
        <Grid x:Name="RightFlash" 
              Opacity="0"
              HorizontalAlignment="Right"
              VerticalAlignment="Stretch"
              Width="100"
              ClipToBounds="True">
            <Ellipse Fill="White" 
                     Width="200" 
                     Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Window}}"
                     HorizontalAlignment="Right"
                     Margin="0,0,-100,0"/>
        </Grid>
        
        <!-- Pause/Play Icon -->
        <Viewbox x:Name="PausePlayIcon" 
                 Width="80" 
                 Height="80"
                 Visibility="Collapsed"
                 HorizontalAlignment="Center"
                 VerticalAlignment="Center">
            <Canvas Width="100" Height="100">
                <!-- Pause Icon (two bars) -->
                <Rectangle x:Name="PauseBar1" 
                          Width="20" 
                          Height="70" 
                          Fill="White" 
                          Canvas.Left="25" 
                          Canvas.Top="15"
                          Opacity="0.6"/>
                <Rectangle x:Name="PauseBar2" 
                          Width="20" 
                          Height="70" 
                          Fill="White" 
                          Canvas.Left="55" 
                          Canvas.Top="15"
                          Opacity="0.6"/>
                <!-- Play Icon (triangle) -->
                <Polygon x:Name="PlayTriangle" 
                        Points="30,15 30,85 80,50" 
                        Fill="White" 
                        Opacity="0.6"
                        Visibility="Collapsed"/>
            </Canvas>
        </Viewbox>
        
        <!-- Speed Indicator -->
        <Border x:Name="SpeedIndicator" 
                Background="#CC000000" 
                Padding="15,10"
                CornerRadius="5"
                Visibility="Collapsed"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
            <TextBlock x:Name="SpeedText" 
                      Foreground="White" 
                      FontSize="32"
                      FontWeight="Bold"
                      Text="5s"/>
        </Border>
        
        <!-- Zoom Indicator -->
        <Border x:Name="ZoomIndicator" 
                Background="#66000000" 
                Padding="12,8"
                CornerRadius="5"
                Visibility="Collapsed"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
            <TextBlock x:Name="ZoomText" 
                      Foreground="White" 
                      FontSize="24"
                      FontWeight="Bold"
                      Text="100%"/>
        </Border>
        
        <!-- Debug Console Overlay -->
        <Border x:Name="DebugConsole" 
                Background="#CC000000" 
                Padding="10"
                Visibility="Collapsed"
                VerticalAlignment="Bottom"
                MaxHeight="200">
            <ScrollViewer VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Hidden">
                <TextBlock x:Name="LogTextBlock" 
                          Foreground="White" 
                          FontFamily="Consolas"
                          FontSize="12"
                          TextWrapping="Wrap"/>
            </ScrollViewer>
        </Border>
    </Grid>
</Window>
